#!/usr/bin/env python3

import socket
import json

def send_command(sock_path, message):
    """Send an IPC message to Niri and return the JSON response."""
    sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
    sock.connect(sock_path)

    if isinstance(message, dict):
        message = json.dumps(message)
    message += "\n"

    sock.sendall(message.encode("utf-8"))
    result = sock.recv(65536)
    sock.close()

    return json.loads(result.decode())
